(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["c86ad352"],{"386d":function(n,e,t){"use strict";var i=t("cb7c"),r=t("83a1"),a=t("5f1b");t("214f")("search",1,function(n,e,t,s){return[function(t){var i=n(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,i):new RegExp(t)[e](String(i))},function(n){var e=s(t,n,this);if(e.done)return e.value;var o=i(n),l=String(this),c=o.lastIndex;r(c,0)||(o.lastIndex=0);var u=a(o,l);return r(o.lastIndex,c)||(o.lastIndex=c),null===u?-1:u.index}]})},4917:function(n,e,t){"use strict";var i=t("cb7c"),r=t("9def"),a=t("0390"),s=t("5f1b");t("214f")("match",1,function(n,e,t,o){return[function(t){var i=n(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,i):new RegExp(t)[e](String(i))},function(n){var e=o(t,n,this);if(e.done)return e.value;var l=i(n),c=String(this);if(!l.global)return s(l,c);var u=l.unicode;l.lastIndex=0;var d,f=[],v=0;while(null!==(d=s(l,c))){var h=String(d[0]);f[v]=h,""===h&&(l.lastIndex=a(c,r(l.lastIndex),u)),v++}return 0===v?null:f}]})},8041:function(n,e,t){"use strict";var i=t("cddb"),r=t.n(i);r.a},"83a1":function(n,e){n.exports=Object.is||function(n,e){return n===e?0!==n||1/n===1/e:n!=n&&e!=e}},"8b24":function(n,e,t){"use strict";t.r(e);var i=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("q-page",{staticClass:"flex flex-center"},[t("q-stepper",{directives:[{name:"show",rawName:"v-show",value:n.visible,expression:"visible"}],ref:"stepper",attrs:{vertical:""}},[t("q-step",{attrs:{default:"",title:"Seleccione fichero de SISS concesiones"}},[t("q-uploader",{attrs:{"hide-upload-button":"",url:""},on:{add:function(e){var t=arguments.length,i=Array(t);while(t--)i[t]=arguments[t];n.loadFile.apply(void 0,["fsiss"].concat(i))}}})],1),t("q-step",{attrs:{title:"Seleccione fichero de incidencias de nóminas"}},[t("q-uploader",{attrs:{"hide-upload-button":"",url:""},on:{add:function(e){var t=arguments.length,i=Array(t);while(t--)i[t]=arguments[t];n.loadFile.apply(void 0,["fnominas"].concat(i))}}})],1),t("q-step",{attrs:{title:"procesar"}},[t("q-btn",{attrs:{label:"Calcula"},on:{click:n.procesa}})],1)],1),t("q-card",{directives:[{name:"show",rawName:"v-show",value:!n.visible,expression:"!visible"}]},[t("q-card-title",{staticClass:"bg-primary text-white"},[n._v("\n    Resultados\n  ")]),t("q-card-separator"),t("q-card-main",[t("div",[n._v("Usuarios en listado SISS: "),t("q-chip",{attrs:{color:"red"}},[n._v(n._s(n.siss.length))])],1),t("div",[n._v("Usuarios en listado Nominas: "),t("q-chip",{attrs:{color:"green"}},[n._v(n._s(n.nomina.length))])],1),t("q-list",[t("q-list-header",[n._v("Está en Nomina pero no en SISS")]),n._l(n.resultadonns,function(e){return t("q-item",{key:e},[n._v("\n        "+n._s(e)+"\n      ")])}),t("q-list-header",[n._v("Está en SISS, pero no en nomina")]),n._l(n.resultadosnn,function(e){return t("q-item",{key:e},[n._v("\n        "+n._s(e)+"\n      ")])})],2)],1)],1)],1)},r=[];i._withStripped=!0;t("386d"),t("ac6a"),t("cadf"),t("551c"),t("4917");var a={name:"PageIndex",data:function(){return{fnominas:null,fsiss:null,textToSearch:/ALTA POR NUEVA CONCESION/,nomina:[],siss:[],PDFLib:null,resultadonns:"",resultadosnn:"",visible:!0}},methods:{buscaDNI:function(n){var e=/[0-9]{8}[TRWAGMYFPDXBNJZSQVHLCKE]/gi,t=n.match(e);return t},buscaNIE:function(n){var e=/[XYZ][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]/gi,t=n.match(e);return t},readfileandextracText:function(n){var e=this;return new Promise(function(t,i){e.PDFLib.getDocument({data:n}).then(function(n){console.log("PDF loaded");var i=n._pdfInfo.numPages;console.log(i);for(var r=[],a=0;a<i;a++)r[a]=e.getTextFromPage(a+1,n);Promise.all(r).then(function(n){t(n)})})})},procesaNominas:function(){var n=this,e=this;return new Promise(function(t,i){n.readfileandextracText(n.fnominas).then(function(n){for(var i=0;i<n.length;i++)if(-1!==n[i].search(e.textToSearch)){console.log("Pagina "+(i+1));var r=e.buscaDNI(n[i]),a=e.buscaNIE(n[i]);null!==r&&(e.nomina=e.nomina.concat(r)),null!==a&&(e.nomina=e.nomina.concat(a))}t(e.nomina)})})},procesaSISS:function(){var n=this,e=this;return new Promise(function(t,i){n.readfileandextracText(n.fsiss).then(function(n){for(var i=0;i<n.length;i++){console.log("Pagina SISS "+(i+1));var r=e.buscaDNI(n[i]),a=e.buscaNIE(n[i]);null!==r&&(e.siss=e.siss.concat(r)),null!==a&&(e.siss=e.siss.concat(a))}t(e.siss)})})},arr_diff:function(n,e){for(var t=[],i=0;i<n.length;i++)-1===e.indexOf(n[i])&&t.push(n[i]);return t},procesa:function(){var n=this,e=window["pdfjs-dist/build/pdf"];e.GlobalWorkerOptions.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.0.943/build/pdf.worker.js",this.PDFLib=e;var t=[],i=this;t[0]=this.procesaNominas(),t[1]=this.procesaSISS(),Promise.all(t).then(function(e){console.log(e[0]),console.log(e[1]);var t=n.arr_diff(e[0],e[1]),r=n.arr_diff(e[1],e[0]);i.resultadonns=t,i.resultadosnn=r,i.visible=!1})},getTextFromPage:function(n,e){return new Promise(function(t,i){e.getPage(n).then(function(n){n.getTextContent().then(function(n){for(var e=n.items,i="",r=0;r<e.length;r++)i+=e[r].str+" ";t(i)})})})},loadFile:function(n,e){var t=e[0],i=new FileReader;i.readAsBinaryString(t);var r=this;i.onload=function(e){r[n]=e.target.result,console.log(r),r.$refs.stepper.next()}}}},s=a,o=(t("8041"),t("2877")),l=Object(o["a"])(s,i,r,!1,null,null,null);l.options.__file="Index.vue";e["default"]=l.exports},cddb:function(n,e,t){}}]);